module.exports=[18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},97877,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(97877).vendored["react-ssr"].ReactJsxRuntime},72131,(a,b,c)=>{"use strict";b.exports=a.r(97877).vendored["react-ssr"].React},25535,a=>{"use strict";var b=a.i(87924),c=a.i(72131);function d(){let[a,d]=(0,c.useState)(null),[e,f]=(0,c.useState)("tokyo"),[g,h]=(0,c.useState)(!1),[i,j]=(0,c.useState)(null),[k,l]=(0,c.useState)(null),[m,n]=(0,c.useState)(null),[o,p]=(0,c.useState)(null),[q,r]=(0,c.useState)(""),s=(0,c.useMemo)(()=>a?URL.createObjectURL(a):null,[a]);async function t(){h(!0),p(null),j(null),l(null),n(null);try{if(!a)throw Error("Nahraj fotku.");let b=new FormData;b.append("file",a),b.append("style",e),b.append("customPrompt",q);let c=await fetch("/api/transform-gemini",{method:"POST",body:b}),d=await c.json();if(!c.ok)throw Error(d?.error||"Request failed");let f=null;if(d.url){f=new URL(d.url,window.location.origin).toString(),j(f),l(f);let a="1"===new URLSearchParams(window.location.search).get("shopify"),b="string"==typeof d.id&&d.id||(f.split("/").pop()??String(Date.now()));a&&window.parent&&window.parent!==window&&(window.parent.postMessage({type:"FM_DESIGN_READY",designUrl:f,designId:b},"*"),console.log("[FM] sent FM_DESIGN_READY",{finalUrl:f,designId:b}))}else if(d.b64)j(`data:${d.mime||"image/png"};base64,${d.b64}`);else throw Error("No image returned");let g={draftOrderId:`draft_${Date.now()}_${Math.random().toString(16).slice(2)}`,createdAt:Date.now(),style:e,originalFileName:a.name,generatedImageUrl:f||"",generatedImageId:d.id};localStorage.setItem("fm_draft_order",JSON.stringify(g)),n(g)}catch(a){p(a?.message??String(a))}finally{h(!1)}}return(0,b.jsxs)("main",{style:{padding:24,fontFamily:"system-ui, sans-serif"},children:[(0,b.jsx)("h1",{style:{fontSize:24,fontWeight:700},children:"FM Proto – photo → style"}),(0,b.jsxs)("div",{style:{marginTop:16,display:"flex",gap:16,alignItems:"center",flexWrap:"wrap"},children:[(0,b.jsx)("input",{type:"file",accept:"image/*",onChange:a=>d(a.target.files?.[0]??null)}),(0,b.jsxs)("select",{value:e,onChange:a=>f(a.target.value),children:[(0,b.jsx)("option",{value:"tokyo",children:"Tokyo Revengers"}),(0,b.jsx)("option",{value:"anime",children:"Anime"}),(0,b.jsx)("option",{value:"simpsons",children:"Simpsons"}),(0,b.jsx)("option",{value:"pixar",children:"3D film look"}),(0,b.jsx)("option",{value:"gta",children:"GTA (Rockstar poster)"})]}),(0,b.jsxs)("div",{style:{marginTop:12},children:[(0,b.jsx)("div",{style:{marginBottom:6,opacity:.8},children:"Custom prompt (volitelné):"}),(0,b.jsx)("input",{value:q,onChange:a=>r(a.target.value),placeholder:'např. "make background neon city, add subtle grain"',style:{width:"100%",maxWidth:640,padding:10}})]}),(0,b.jsx)("button",{onClick:t,disabled:g,style:{padding:"10px 14px"},children:g?"Generating...":"Generate"}),(0,b.jsx)("button",{onClick:function(){p(null);try{let a=localStorage.getItem("fm_draft_order");if(!a){n(null),l(null);return}let b=JSON.parse(a);n(b),l(b.generatedImageUrl||null)}catch(a){p(a?.message??String(a))}},style:{padding:"10px 14px"},children:"Load saved draft"}),(0,b.jsx)("button",{onClick:function(){localStorage.removeItem("fm_draft_order"),n(null),l(null)},style:{padding:"10px 14px"},children:"Clear draft"})]}),s&&(0,b.jsxs)("div",{style:{marginTop:16},children:[(0,b.jsx)("div",{style:{marginBottom:8,opacity:.8},children:"Original preview:"}),(0,b.jsx)("img",{src:s,alt:"Original",style:{width:256,borderRadius:10}})]}),o&&(0,b.jsx)("p",{style:{color:"red",marginTop:12},children:o}),i&&(0,b.jsxs)("div",{style:{marginTop:16},children:[(0,b.jsx)("div",{style:{marginBottom:8,opacity:.8},children:"Generated:"}),(0,b.jsx)("img",{src:i,alt:"Generated",style:{width:512,borderRadius:10}})]}),(m||k)&&(0,b.jsxs)("div",{style:{marginTop:20,padding:12,border:"1px solid #333",borderRadius:10},children:[(0,b.jsx)("div",{style:{fontWeight:700,marginBottom:8},children:"Order draft (simulace)"}),m?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("b",{children:"draftOrderId:"})," ",m.draftOrderId]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("b",{children:"style:"})," ",m.style]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("b",{children:"originalFileName:"})," ",m.originalFileName]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("b",{children:"generatedImageId:"})," ",m.generatedImageId??"-"]}),(0,b.jsxs)("div",{style:{marginTop:8},children:[(0,b.jsx)("b",{children:"generatedImageUrl:"})," ",(0,b.jsx)("a",{href:m.generatedImageUrl,target:"_blank",rel:"noreferrer",children:m.generatedImageUrl})]})]}):(0,b.jsxs)("div",{style:{opacity:.8},children:["Draft není v paměti komponenty, ale URL je uložená:"," ",(0,b.jsx)("a",{href:k??"",target:"_blank",rel:"noreferrer",children:k})]})]})]})}a.s(["default",()=>d])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__334cda78._.js.map